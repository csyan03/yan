<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>雷东燕</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: none;
        }

        body {
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #000000; /* 新增背景色设置 */
        }

        .container {
            position: relative;
            height: 100vh;
            width: 100vw;
        }

        .folder {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }

        .carousel {
            display: flex;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }

        .item {
            flex: 0 0 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        img, video {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            pointer-events: none; /* 新增：禁止媒体元素交互 */
        }

        video {
            background-color: black;
             /* 在原有样式基础上添加以下优化 */
        transform: translate3d(0,0,0); /* 启用硬件加速 */
        will-change: transform; /* 提示浏览器提前优化 */
        }
.caption {
    position: absolute;
    bottom: 0px;
    left: 0px;
    right: 20px;
    color: #FFFFFF;
    font-size: 14px;
    line-height: 1.5;
    background: rgba(255, 255, 255, 0);
    padding: 15px;
    border-radius: 8px;
    z-index: 100;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    pointer-events: none;
    text-align: left; /* 文字左对齐 */
    width: calc(100% - 0px); /* 左右各留0px边距 */
    margin: 0 auto; /* 水平居中 */
    max-width: none; /* 移除最大宽度限制 */
        }
        .caption br {
            display: block;
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Folder 1 -->
        <div class="folder" data-bgm="250113.mp3" style="transform: translateY(0%)">
            <div class="caption">
                2025年01月13日<br><br>
                我决定做一个照照镜子就能开心一整天的人#我决定重新爱上阳光#每一种生活都值得被记录<br><br>
                BGM：跳楼机(1.1)_我们的感情好像跳楼机-FBI利比
            </div>
            <audio class="bgm" loop>
                <source src="250113.mp3" type="audio/mpeg">
            </audio>
            <div class="carousel">
                <div class="item"><img src="250113-1.webp"></div>
                <div class="item"><img src="250113-2.webp"></div>
                <div class="item"><img src="250113-3.webp"></div>
                <div class="item"><img src="250113-4.webp"></div>
                <div class="item"><img src="250113-5.webp"></div>
                <div class="item"><img src="250113-6.webp"></div>
                <div class="item"><img src="250113-7.webp"></div>
            </div>
        </div>

        <!-- Folder 2 -->
        <div class="folder" data-bgm="241116.mp3" style="transform: translateY(100%)">
            <div class="caption">
                2024年11月16日<br><br>
                <br><br>
                BGM：幸福总是二倍速 佳梁 专属原声
            </div>
            <audio class="bgm" loop>
                <source src="241116.mp3" type="audio/mpeg">
            </audio>
            <div class="carousel">
                <!-- 移除controls属性 -->
                <div class="item"><video loop muted><source src="241116-1.mp4" type="video/mp4"></video></div>
                <div class="item"><video loop muted><source src="241116-2.mp4" type="video/mp4"></video></div>
            </div>
        </div>

        <!-- Folder 3 -->
        <div class="folder" data-bgm="241022.mp3" style="transform: translateY(200%)">
            <div class="caption">
                2024年10月22日<br><br>
                有迹可循的moment#宝宝你看镜头#一直在一起的人才值得炫耀<br><br>
                BGM：忘见川创建的原声
            </div>
            <audio class="bgm" loop>
                <source src="241022.mp3" type="audio/mpeg">
            </audio>
            <div class="carousel">
                <!-- 移除controls属性 -->
                <div class="item"><video loop muted><source src="241022-1.mp4" type="video/mp4"></video></div>
                <div class="item"><video loop muted><source src="241022-2.mp4" type="video/mp4"></video></div>
                <div class="item"><video loop muted><source src="241022-3.mp4" type="video/mp4"></video></div>
                <div class="item"><video loop muted><source src="241022-4.mp4" type="video/mp4"></video></div>
                <div class="item"><video loop muted><source src="241022-5.mp4" type="video/mp4"></video></div>
            </div>
        </div>
        <!-- Folder 4 -->
        <div class="folder" data-bgm="240912.mp3" style="transform: translateY(300%)">
             <div class="caption">
                  2024年09月12日<br><br>
                  于是 我驻足。@L<br><br>
                  BGM：你是我的风景-李涵野
             </div>
         <audio class="bgm" loop>
        <source src="240912.mp3" type="audio/mpeg">
    </audio>
    <div class="carousel">
                  <div class="item"><img src="240912-1.webp"></div>
                  <div class="item"><img src="240912-2.webp"></div>
    </div>
</div>
<!-- 原有文件夹1-4代码... -->

<!-- Folder 5 -->
<div class="folder" data-bgm="240808.mp3" style="transform: translateY(400%)">
    <div class="caption">
        2024年08月08日<br><br>
        冬天来的时候你还在不在#原相机live#冬天<br><br>
        BGM：认真的雪-李佩玲
    </div>
    <audio class="bgm" loop>
        <source src="240808.mp3" type="audio/mpeg">
    </audio>
    <div class="carousel">
        <div class="item"><img src="240808.webp"></div>
    </div>
</div>

<!-- Folder 6 -->
<div class="folder" data-bgm="240603.mp3" style="transform: translateY(500%)">
    <div class="caption">
        2024年06月03日<br><br>
        #生活碎片记录<br><br>
        BGM：冬眠·2023-阿YueYue刘兆宇
    </div>
    <audio class="bgm" loop>
        <source src="240603.mp3" type="audio/mpeg">
    </audio>
    <div class="carousel">
        <div class="item"><img src="240603-1.webp"></div>
        <div class="item"><img src="240603-2.webp"></div>
        <div class="item"><img src="240603-3.webp"></div>
    </div>
</div>

<!-- Folder 7 -->
<div class="folder" data-bgm="240501.mp3" style="transform: translateY(600%)">
    <div class="caption">
        2024年05月01日<br><br>
        Oh爱本是尘埃#夏天的味道#原相机#分享照片<br><br>
        BGM：爱本是尘埃(降调版)_胖猫
    </div>
    <audio class="bgm" loop>
        <source src="240501.mp3" type="audio/mpeg">
    </audio>
    <div class="carousel">
        <div class="item"><video loop muted preload="metadata" playsinline><source src="240501-1.mp4" type="video/mp4"></video></div>
        <div class="item"><video loop muted preload="metadata" playsinline><source src="240501-2.mp4" type="video/mp4"></video></div>
    </div>
</div>

<!-- Folder 8 -->
<div class="folder" data-bgm="240116.mp3" style="transform: translateY(700%)">
    <div class="caption">
        2024年01月16日<br><br>
        幸福开始有预兆<br><br>
        BGM：傻瓜 珍惜才配拥有-纯音乐小助手
    </div>
    <audio class="bgm" loop>
        <source src="240116.mp3" type="audio/mpeg">
    </audio>
    <div class="carousel">
        <div class="item"><video loop muted><source src="240116.mp4" type="video/mp4"></video></div>
    </div>
</div>
    </div>

 <script>
let startX, startY;
let currentFolderIndex = 0;
let currentItems = new Array(document.querySelectorAll('.folder').length).fill(0);
const folders = document.querySelectorAll('.folder');
const bgms = document.querySelectorAll('.bgm');

// 初始化：只加载首屏内容
document.addEventListener('DOMContentLoaded', () => {
    folders.forEach((folder, index) => {
        if (index !== 0) {
            folder.querySelectorAll('video source').forEach(source => {
                source.parentElement.removeAttribute('src'); // 清空非首屏视频源
            });
        }
    });
    playCurrentBGM();
    playCurrentVideo();
});

// 触摸事件处理
document.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
});

document.addEventListener('touchend', e => {
    const deltaX = e.changedTouches[0].clientX - startX;
    const deltaY = e.changedTouches[0].clientY - startY;

    if (Math.abs(deltaY) > 50) {
        handleVerticalSwipe(deltaY);
    } else if (Math.abs(deltaX) > 50) {
        handleHorizontalSwipe(deltaX);
    }
});

function handleVerticalSwipe(deltaY) {
    const newIndex = deltaY > 0 
        ? Math.max(0, currentFolderIndex - 1)
        : Math.min(folders.length - 1, currentFolderIndex + 1);
    
    if (newIndex !== currentFolderIndex) {
        currentFolderIndex = newIndex;
        updateFolders();
    }
}

function handleHorizontalSwipe(deltaX) {
    const folder = folders[currentFolderIndex];
    const itemCount = folder.querySelectorAll('.item').length;
    const newPosition = deltaX > 0
        ? Math.max(0, currentItems[currentFolderIndex] - 1)
        : Math.min(itemCount - 1, currentItems[currentFolderIndex] + 1);

    if (newPosition !== currentItems[currentFolderIndex]) {
        currentItems[currentFolderIndex] = newPosition;
        updateCarousel(folder);
    }
}

// 更新文件夹显示
function updateFolders() {
    folders.forEach((folder, index) => {
        const distance = Math.abs(index - currentFolderIndex);
        folder.style.transform = `translateY(${(index - currentFolderIndex) * 100}%)`;

        // 动态加载控制
        manageMediaLoading(folder, distance);
    });

    currentItems[currentFolderIndex] = 0; // 重置轮播位置
    updateCarousel(folders[currentFolderIndex]);
    playCurrentBGM();
}

// 媒体资源加载管理
function manageMediaLoading(folder, distance) {
    // 视频处理
    folder.querySelectorAll('video').forEach(video => {
        const source = video.querySelector('source');
        
        if (distance === 0) { // 当前文件夹
            if (!video.dataset.loaded) {
                video.innerHTML = `<source src="${source.dataset.src}" type="video/mp4">`;
                video.dataset.loaded = true;
                video.preload = 'auto';
            }
            video.play();
        } else if (distance === 1) { // 相邻文件夹
            if (!video.dataset.loaded) {
                video.preload = 'metadata';
            }
        } else { // 其他文件夹
            video.pause();
            video.removeAttribute('src');
            video.load();
            video.dataset.loaded = false;
        }
    });

    // 图片预加载
    if (distance <= 1) {
        folder.querySelectorAll('img[data-src]').forEach(img => {
            if (!img.src) {
                img.src = img.dataset.src;
                img.removeAttribute('data-src');
            }
        });
    }
}

// 更新轮播位置
function updateCarousel(folder) {
    folder.querySelector('.carousel').style.transform = 
        `translateX(${-currentItems[currentFolderIndex] * 100}%)`;
    playCurrentVideo();
}

// 音频控制
function playCurrentBGM() {
    bgms.forEach((bgm, index) => {
        if (index === currentFolderIndex) {
            bgm.currentTime = 0;
            bgm.play().catch(() => {}); // 防止自动播放限制报错
        } else {
            bgm.pause();
        }
    });
}

// 视频控制
function playCurrentVideo() {
    const folder = folders[currentFolderIndex];
    const currentItem = folder.querySelectorAll('.item')[currentItems[currentFolderIndex]];
    
    folder.querySelectorAll('video').forEach(video => {
        video.pause();
        video.currentTime = 0;
    });

    const video = currentItem.querySelector('video');
    if (video) {
        video.play().catch(() => {}); // 处理自动播放限制
        video.muted = false;
    }
}

// 点击控制
document.addEventListener('click', () => {
    const currentFolder = folders[currentFolderIndex];
    const bgm = currentFolder.querySelector('.bgm');
    
    bgm.paused ? bgm.play() : bgm.pause();
    currentFolder.querySelectorAll('video').forEach(video => {
        video.paused ? video.play() : video.pause();
    });
});
</script>
</body>
</html>